# 새롭게 추가된 기능

- 스트림 API
- 메서드에 코드를 전달하는 기법(메서드 레퍼런스와 람다)
- 인터페이스의 디폴트 메서드

## 스트림 API

데이터베이스 질의 언어에서 표현식을 처리하는 것처럼 **병렬 연산을 지원하는 스트림이라는 새로운 API**를 제공. 데이터베이스 질의 언어에서 고수준 언어로 원하는 동작을 표현하면, 구현에서 최적의 저수준 실행 방법을 선택하는 방식으로 동작한다. 즉 **에러를 자주 일으키며 멀티코어 CPU를 이용하는 것보다 비용이 훨씬 비싼 synchronized를 사용하지 않아도 된다**.

조금 다른 관점에서 보면 결국 **스트림API 덕분에 메서드에 코드를 전달하는 기법과 인터페이스의 디폴트 메서드가 추가**되었음을 알 수 있습니다.

**메서드에 코드를 전달**하는 기법을 이용하면 새롭고 간결한 방식으로 **동작 파라미터화(behavior parameterization)**을 구현할 수 있습니다. 이전 버전의 자바에서 익명클래스를 이용하여 동작파라미터를 구현할 수 있었지만 재사용이 힘들었고 코드가 불필요하게 장황해지는 단점이 있었는데, Java 8에서는 메서드 레퍼런스와 람다를 이용하여 위의 단점을 해결하였다.
위 기능은 함수형 프로그래밍에서 위력을 발휘한다.

## 스트림 처리(Stream Processing)

**스트림**이란 **한번에 한 개씩 만들어지는 연속적인 데이터항목들의 모임**을 의미합니다. 프로그램은 입력 스트림에서 데이터를 한 개씩 읽어 들이며 출력 스트림으로 데이터를 한 개씩 기록한다. 즉, 어떤 프로그램의 출력 스트림은 다른 프로그램의 입력 스트림이 될 수 있다.

Java8에는 Java.util.stream 패키지에 스트림 API가 추가되었다.
Stream<T> 간단하게 말하여 **스트림 API는 조립라인 처럼 어떤 항목을 연속적으로 제공하는 어떤 기능**이라고 설명할 수 있다. 

스트림 API의 핵심은 기존에는 **한번에 한 항목을 처리했지만 작업을 고수준으로 추상화해 일련의 스트림으로 만들어 처리할 수 있다는 것**. 또한 스트림 파이프라인을 이요해 입력 부분을 여러 CPU코어에 쉽게 할당할 수 있다는 부가적인 이득도 얻을 수 있다. **스레드라는 복잡한 작업을 사용하지 않고도 병렬성을 얻을 수 있게 된것이다.** 

## 동작 파라미터화로 메서드에 코드 전달하기

Java8에서는 코드 일부를 API로 전달할 수 있다. 즉 **메서드를 다른 메서드의 인수로 넘겨주는 기능을 제공**한다. 이러한 기능을 **동작 파라미터화**라고 부른다. 이를 통해 익명 클래스를 활용하던 것과 비교하여 재사용성이 증가하고 코드가 더 간결해지는 이점을 얻을 수 있습니다.

## 병렬성과 공유 가변 데이터

스트림 메서드로 전달하는 코드는 **다른 코드와 동시에 실행하더라도 안전하게 실행**될 수 있어야 한다. 보통 다른 코드와 동시에 실행하더라도 안전하게 실행할 수 있는 코드를 만들려면 **공유된 가변 데이터**에 접근하지 않아야한다. 이러한 함수를 순수함수, 부작용없는함수, 상태없는함수라고 부른다.

물론 기존처럼 synchronized를 이용해 공유된 가변 데이터를 보호하는 규칙을 만들 수 있다. 하지만 일반적으로. synchronized는 시스템 성능에 악영향을 미치고 다중 프로세싱 코어에서 비싼 비용을 치러야하기 때문에 기피하는 기능 중 하나이다. Java8에서 스트림을 이용하면 **기존 자바 스레드 API보다 쉽게 병렬성을 활용할 수 있습니다**.

위에서 말한 부분이 **함수형 프로그램의 핵심적인 사항**들이다.

## 자바 함수

프로그래밍 언어에서는 **함수==메서드==정적메서드**와 같은 의미로 사용된다. 자바의 함수는 이에 더해 **수학적인 함수처럼 사용되며 부작용을 일으키지 않은 함수**를 의미한다. 

프로그래밍 언어의 핵심은 값을 바꾸는 것이다. 이 값을 일급값(일급시민, 일급객체)이라고 한다. 프로그래머들에게 일급시민이라는 용어가 더 익술할 것이다. 일급시민이 되기 위한 조건은 아래와 같다

- 변수나 데이터 구조안에 담을 수 있다.
- 파라미터로 전달 할 수 있다.
- 반환값으로 사용할 수 있다.
- 할당에 사용된 이름과 관계없이 고유한 구별이 가능하다.
- 동적으로 프로퍼티 할당이 가능하다.

자바에서 메서드와 클래스 등은 이급시민에 해당한다. Java8에서는 이와 같은 이급시민을 일급시민으로 바꿀 수 있는 기능을 추가했다.

## 메서드와 람다를 일급 시민으로

### 메서드 레퍼런스

위 기능은 디렉터리에서 숨겨진 파일을 필터링하는 예저를 통해 설명하자면 다음과 같다. 기존 자바의 익명클래스 기능을 이용하여 해당 기능을 작성해본다.![스크린샷 2019-11-16 오후 11.20.21](/Users/user/Desktop/스크린샷 2019-11-16 오후 11.20.21.png)

이 해당 코드를 Java8의 방식으로 바꿔보면
FIle[] hiddenFiles = new File(".").listFiles(File:isHidden);

isHidden이라는 **함수**는 이미 준비되어 있으므로 익명클래스로 구현하던 부분을 메서드레퍼런스(::, 메서드를 값으로 사용하라는 의미)를 이용하여 listFiles에 직접 전달할 수 있다. 여기서 메서드라는 용어대신 함수라는 용어를 사용했다는 것도 중요한 부분이다.

### [람다: 익명함수]

Java8에서는 람다(익명함수)를 포함하여 함수도 값으로 취급할 수 있다.
(int x) -> x+1 // x라는 인수로 호출하면 x+1을 반환
위처럼 표현할 수 있다.
이를 활용하면 **한번만 사용될 함수를 따로 정의하지 않아도 된다는 장점**을 가질 수 있다.

## 스트림

기존 자바 컬렉션에 특정 데이터만 필터링하여 저장해야한다면 반복문과 조건문을 이용하여 필터링 후 특정 컬렉션에 저장하는 방법을 사용했다. 이를 **외부 반복**이라고 한다.

Java8에서는 스트림 API를 이용하여 라이브러리 내부에서 모든 데이터가 처리되게 할 수 있다. 이를 내부 반복이라고 한다. 이를 리스트에서 고가의 거래만 필터링하는 예제로 작성해보면 아래와 같다.

![스크린샷 2019-11-16 오후 11.29.42](/Users/user/Desktop/스크린샷 2019-11-16 오후 11.29.42.png)

추가적인 반복문이나 조건문 없이도 위와 같이 구현할 수 있다.

이와 같이 **스트림 API의 활용으로 컬렉션을 처리하면서 발생하는 모호함과 반복적인 코드문제와 멀티코어 활용의 어려움이라는 두가지 문제를 해결할 수 있다**. 

## 디폴트 메서드

디폴트 메서드는

14:09:11	alter table notice add id INT NOT NULL, add constraint fk_notice foreign key(id) references tmember(id)	Error Code: 3780. Referencing column 'id' and referenced column 'id' in foreign key constraint 'fk_notice' are incompatible.	0.00071 sec

<input type="text" name="text" size="20" style="width:100%; border: 0;"> <textarea name="content" rows="10" style="width:100%; border: 0; resize: none;"></textarea>

출처: https://tastyloper.tistory.com/1 [tastyloper]



1. 데이터 추가 (4800개->400개) api 2개를 활용해서, 공공데이터포털에서 식품정보 데이터를 마이닝하였고, 그 과정에서 데이터가 정제되었다.

2. 페이지네이션이 모든 목록페이지에 추가되었다.

3. 데이터베이스에 유사도 계산을 한 결과값 DB에 저장하여 시간개선

4. 알레르기 성분 경고

5. 영양정보에 따른 경고

6. Q&A 댓글기능

7. 로그인을 제외한 모든부분 Vue로 변경

   강사님 앞자리 두명

**754b524978706a6836305946755a5a**



























